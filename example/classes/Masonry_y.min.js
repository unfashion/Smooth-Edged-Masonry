export default class Masonry{constructor(t){this.breakPoints=t.breakPoints?t.breakPoints:[0,400,1e3],this.columns=t.columns?t.columns:[1,2,3],this.gaps=t.gaps?t.gaps:["3px","3px","4px"],this.mainContainer=t.mainContainer?document.querySelector(t.mainContainer):document.querySelector(".unf-masonry"),this.itemContainer=t.itemContainer?t.itemContainer:".picture",this.masonryItems=this.mainContainer.querySelectorAll(this.itemContainer),this.zoom=t.zoom?t.zoom:void 0,this.setMainContainerStyles(),this.preBuild(),this.adaptDefine(),document.addEventListener("DOMContentLoaded",(()=>{this.build(),this.loadImg(),window.addEventListener("load",(()=>{this.reConstruct(),window.addEventListener("resize",(()=>this.onResize()))}))}))}adaptDefine(){this.breakPoints.forEach(((t,i)=>{this.mainContainer.clientWidth>=t&&(this.columnsCount=this.columns[i],this.gap=this.gaps[i])}))}onResize(){this.setMainContainerWidth(),this.adaptDefine(),this.mainContainerNewWidth=this.mainContainer.clientWidth,this.mainContainerWidth!=this.mainContainerNewWidth&&this.reConstruct()}reConstruct(){this.loadingImg=0,this.build(),this.masonryItems.forEach(((t,i)=>{this.item=t,t.removeAttribute("style"),this.place(),i==this.masonryItems.length-1&&this.colsAlign()}))}preBuild(){this.masonryItems.forEach((t=>{t.querySelector("a").style.cssText="\n            width: 100%;\n            height: 100%; \n            display: block; \n            line-height: 0px;\n            overflow: hidden; \n            "})),this.loadingImg=0,this.setMainContainerWidth(),this.masonryItems.forEach((t=>{t.removeAttribute("style"),t.style.cssText="display: none; opacity: 0;"}))}build(){this.mainContainerWidth=this.mainContainer.clientWidth,this.columnWidth=this.mainContainerWidth/this.columnsCount,this.columnsX=[],this.columnsY=[],this.columnsElementsCollection=[];for(let t=0;t<this.mainContainerWidth;t+=this.columnWidth)this.columnsX.push(t),this.columnsY.push(0),this.columnsElementsCollection.push([])}loadImg(){this.item=this.masonryItems[this.loadingImg];let t=this.item.querySelector("img");t.style.cssText="width: 100%; height: 100%; object-fit: cover;",this.zoom&&(t.style.transition=`all ${this.zoom} cubic-bezier(0.19, 0.15, 0.38, 1.14)`,t.addEventListener("mouseover",(()=>t.style.transform="scale(1.2)")),t.addEventListener("mouseout",(()=>t.style.transform=""))),t.complete?this.afterLoad():t.onload=()=>this.afterLoad()}afterLoad(){this.item.removeAttribute("style"),this.place(),this.loadingImg<this.masonryItems.length-1?(this.loadingImg=this.loadingImg+1,this.setMainContainerHeight(),this.loadImg()):this.reConstruct()}setMainContainerHeight(){this.mainContainer.style.height=Math.max(...this.columnsY)+"px"}setMainContainerWidth(){this.mainContainer.style.width=`calc(100% + ${this.gap})`,this.mainContainer.style.marginTop=`-${this.gap}`,this.mainContainer.style.marginLeft=`-${this.gap}`}setMainContainerStyles(){this.mainContainer.style.cssText="display: block; position: relative; height: 100%; overflow: hidden;"}place(){this.item.style.cssText=`\n        box-sizing: border-box;\n        position: absolute;\n        padding-top: ${this.gap};\n        padding-left: ${this.gap};\n        width: ${this.columnWidth+"px"};\n        `;this.item.clientHeight;let t=Math.min(...this.columnsY),i=this.columnsY.indexOf(t);this.item.style.left=this.columnsX[i]+"px",this.columnsElementsCollection[i].push(this.item),this.item.style.top=t+"px",this.columnsY[i]=this.columnsY[i]+this.item.clientHeight}colsAlign(){let t=this.columnsY.reduce(((t,i)=>t+i))/this.columnsY.length;this.mainContainer.style.height=t+"px";for(let i=0;i<this.columnsY.length;i++){let e=0;for(let s=0;s<this.columnsElementsCollection[i].length;s++){let n=this.columnsElementsCollection[i][s],o=n.clientHeight*t/this.columnsY[i];n.style.height=o+"px",n.style.top=e+"px",e+=o}}}}